---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// 1. Générer les chemins pour chaque article
export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug }, props: { entry },
  }));
}

// 2. Récupérer l'article via les props
const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={entry.data.title}>
  <main class="min-h-screen bg-slate-950 text-slate-200 p-8 font-sans">
    <article class="max-w-3xl mx-auto">
      <a href="/" class="text-blue-400 hover:text-blue-300 text-sm mb-8 inline-block">
        ← Retour au portfolio
      </a>
      
      <header class="mb-8">
        <h1 class="text-4xl font-bold text-white mb-2">{entry.data.title}</h1>
        <p class="text-slate-500 font-mono text-sm">
          Publié le {entry.data.pubDate.toLocaleDateString('fr-FR')}
        </p>
      </header>

      <div class="prose prose-invert prose-blue max-w-none">
        <Content />
      </div>
    </article>
  </main>
</Layout>

<style is:global>
  /* Style minimal pour le contenu Markdown */
  .prose h2 { @apply text-2xl font-bold text-white mt-8 mb-4; }
  .prose p { @apply text-slate-300 leading-relaxed mb-4; }
  .prose code { @apply bg-slate-800 px-1 py-0.5 rounded text-blue-300 font-mono text-sm; }
</style>
